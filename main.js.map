{"version":3,"file":"main.js","sources":["src/previewView.ts","src/settings.ts","src/extraction.ts","src/main.ts","src/synthesis.ts"],"sourcesContent":["import { ItemView, WorkspaceLeaf } from 'obsidian';\n\nexport const PREVIEW_VIEW_TYPE = 'remotion-preview-view';\n\nexport class PreviewView extends ItemView {\n    private iframe: HTMLIFrameElement | null = null;\n\n    constructor(leaf: WorkspaceLeaf) {\n        super(leaf);\n        this.icon = 'video';\n    }\n\n    getViewType(): string {\n        return PREVIEW_VIEW_TYPE;\n    }\n\n    getDisplayText(): string {\n        return 'Remotion Preview';\n    }\n\n    async onOpen() {\n        const container = this.containerEl.children[1] as HTMLElement;\n        container.empty();\n        container.addClass('remotion-preview-container');\n\n        // Create iframe for Remotion runtime\n        this.iframe = container.createEl('iframe', {\n            cls: 'remotion-preview-iframe',\n        });\n        this.iframe.style.width = '100%';\n        this.iframe.style.height = '100%';\n        this.iframe.style.border = 'none';\n        this.iframe.style.backgroundColor = '#000';\n\n        // Initialize iframe with a simple runtime that renders synthesized module output\n        this.iframe.srcdoc = `\n            <!DOCTYPE html>\n            <html>\n            <head>\n                <meta charset=\"utf-8\">\n                <style>\n                    body { \n                        margin: 0; \n                        padding: 20px;\n                        font-family: system-ui;\n                        background: #1a1a1a;\n                        color: #fff;\n                    }\n                    pre {\n                        white-space: pre-wrap;\n                        word-break: break-word;\n                        background: #111;\n                        padding: 12px;\n                        border-radius: 6px;\n                        border: 1px solid #333;\n                    }\n                </style>\n            </head>\n            <body>\n                <h2>Remotion Preview</h2>\n                <p>Preview panel initialized. Awaiting synthesized module...</p>\n                <pre id=\"extract-output\">No data yet</pre>\n                <script>\n                    window.addEventListener('message', (event) => {\n                        const data = event.data;\n                        if (!data || data.type !== 'synthesized-module') return;\n                        const pre = document.getElementById('extract-output');\n                        pre.textContent = data.payload || 'No data';\n                    });\n                </script>\n            </body>\n            </html>\n        `;\n    }\n\n    async onClose() {\n        this.iframe = null;\n    }\n\n    public updateSynthesizedModule(code: string) {\n        if (!this.iframe?.contentWindow) return;\n        this.iframe.contentWindow.postMessage({\n            type: 'synthesized-module',\n            payload: code,\n        }, '*');\n    }\n}\n","import { App, PluginSettingTab, Setting } from 'obsidian';\n\nexport interface PluginSettings {\n    defaultFps: number;\n    defaultWidth: number;\n    defaultHeight: number;\n}\n\nexport const DEFAULT_SETTINGS: PluginSettings = {\n    defaultFps: 30,\n    defaultWidth: 1920,\n    defaultHeight: 1080,\n};\n\nexport class RemotionSettingTab extends PluginSettingTab {\n    plugin: any;\n\n    constructor(app: App, plugin: any) {\n        super(app, plugin);\n        this.plugin = plugin;\n    }\n\n    display(): void {\n        const { containerEl } = this;\n\n        containerEl.empty();\n        containerEl.createEl('h2', { text: 'Remotion Preview Settings' });\n\n        new Setting(containerEl)\n            .setName('Default FPS')\n            .setDesc('Default frames per second for Remotion compositions.')\n            .addText(text => text\n                .setValue(String(this.plugin.settings.defaultFps))\n                .onChange(async (value) => {\n                    const fps = parseInt(value);\n                    if (!isNaN(fps) && fps > 0) {\n                        this.plugin.settings.defaultFps = fps;\n                        await this.plugin.saveSettings();\n                    }\n                }));\n\n        new Setting(containerEl)\n            .setName('Default Width')\n            .setDesc('Default composition width in pixels.')\n            .addText(text => text\n                .setValue(String(this.plugin.settings.defaultWidth))\n                .onChange(async (value) => {\n                    const width = parseInt(value);\n                    if (!isNaN(width) && width > 0) {\n                        this.plugin.settings.defaultWidth = width;\n                        await this.plugin.saveSettings();\n                    }\n                }));\n\n        new Setting(containerEl)\n            .setName('Default Height')\n            .setDesc('Default composition height in pixels.')\n            .addText(text => text\n                .setValue(String(this.plugin.settings.defaultHeight))\n                .onChange(async (value) => {\n                    const height = parseInt(value);\n                    if (!isNaN(height) && height > 0) {\n                        this.plugin.settings.defaultHeight = height;\n                        await this.plugin.saveSettings();\n                    }\n                }));\n    }\n}\n","import { MarkdownView } from 'obsidian';\n\nexport interface CodeBlock {\n    content: string;\n    language: string;\n    startLine: number;\n    endLine: number;\n    startOffset: number;\n    endOffset: number;\n}\n\nexport type BlockType = 'module' | 'jsx-entry';\n\nexport interface ClassifiedBlock extends CodeBlock {\n    type: BlockType;\n    blockIndex: number;\n}\n\n/**\n * Extract all fenced code blocks with language ts, tsx, or typescript from markdown content.\n * \n * @param content Raw markdown content string\n * @returns Array of extracted code blocks with line and offset information\n */\nexport function extractCodeBlocks(content: string): CodeBlock[] {\n    const blocks: CodeBlock[] = [];\n    const lines = content.split('\\n');\n    \n    let i = 0;\n    let currentOffset = 0;\n\n    while (i < lines.length) {\n        const line = lines[i];\n        const trimmed = line.trim();\n\n        // Look for opening fence (``` or ~~~)\n        if ((trimmed.startsWith('```') || trimmed.startsWith('~~~')) && trimmed.length >= 3) {\n            const fence = trimmed.startsWith('```') ? '```' : '~~~';\n            const fenceChar = fence[0];\n            \n            // Extract language from the opening fence\n            const languageMatch = trimmed.slice(3).match(/^\\w+/);\n            const language = languageMatch ? languageMatch[0] : '';\n\n            // Only process ts, tsx, typescript blocks\n            if (['ts', 'tsx', 'typescript'].includes(language)) {\n                const startLine = i;\n                const startOffset = currentOffset;\n                let blockContent = '';\n                \n                i++; // Move to line after opening fence\n                currentOffset += line.length + 1; // +1 for newline\n\n                // Collect content until closing fence\n                while (i < lines.length) {\n                    const contentLine = lines[i];\n                    const contentTrimmed = contentLine.trim();\n\n                    // Check for closing fence\n                    if (contentTrimmed.startsWith(fenceChar) && contentTrimmed.length >= 3) {\n                        const endOffset = currentOffset;\n                        const endLine = i;\n\n                        blocks.push({\n                            content: blockContent.trimEnd(), // Remove trailing whitespace\n                            language,\n                            startLine,\n                            endLine,\n                            startOffset,\n                            endOffset,\n                        });\n\n                        currentOffset += contentLine.length + 1;\n                        i++;\n                        break;\n                    }\n\n                    blockContent += contentLine + '\\n';\n                    currentOffset += contentLine.length + 1;\n                    i++;\n                }\n            } else {\n                // Not a ts/tsx block, skip to next line\n                currentOffset += line.length + 1;\n                i++;\n            }\n        } else {\n            currentOffset += line.length + 1;\n            i++;\n        }\n    }\n\n    return blocks;\n}\n\n/**\n * Extract code blocks from the active markdown view.\n * \n * @param view The active MarkdownView\n * @returns Array of extracted code blocks, or empty array if view is not markdown\n */\nexport function extractFromView(view: MarkdownView): CodeBlock[] {\n    const content = view.editor.getValue();\n    return extractCodeBlocks(content);\n}\n\n/**\n * Map a code block to markdown line and column position.\n * Useful for reverse-mapping diagnostics from the virtual TS module back to markdown.\n * \n * @param block The code block\n * @param lineInBlock Line number within the block content (0-indexed)\n * @returns { line, column } in markdown document\n */\nexport function blockPositionToMarkdown(\n    block: CodeBlock,\n    lineInBlock: number\n): { line: number; column: number } {\n    // +1 for the opening fence line, then add lineInBlock\n    return {\n        line: block.startLine + 1 + lineInBlock,\n        column: 0,\n    };\n}\n\nfunction isLikelyJsxEntry(content: string): boolean {\n    const trimmed = content.trim();\n    if (!trimmed.startsWith('<')) return false;\n\n    // Heuristic: if it contains module keywords, treat as module code\n    const keywordPattern = /\\b(import|export|const|function|class)\\b/;\n    if (keywordPattern.test(trimmed)) return false;\n\n    // Require a JSX-like closing\n    if (!(trimmed.endsWith('>') || trimmed.endsWith('/>'))) return false;\n\n    return true;\n}\n\n/**\n * Classify extracted code blocks into module blocks and JSX entry blocks.\n *\n * @param blocks Extracted code blocks\n * @returns Classified blocks with block indices\n */\nexport function classifyBlocks(blocks: CodeBlock[]): ClassifiedBlock[] {\n    return blocks.map((block, index) => ({\n        ...block,\n        blockIndex: index,\n        type: isLikelyJsxEntry(block.content) ? 'jsx-entry' : 'module',\n    }));\n}\n\n/**\n * Synthesize a virtual TSX module by concatenating module blocks and wrapping JSX entry blocks.\n *\n * @param notePath Original markdown file path\n * @param blocks Classified blocks\n * @returns Synthesized module output with scene exports metadata\n */\n","import { Plugin, WorkspaceLeaf, MarkdownView } from 'obsidian';\nimport { PreviewView, PREVIEW_VIEW_TYPE } from './previewView';\nimport { PluginSettings, DEFAULT_SETTINGS, RemotionSettingTab } from './settings';\nimport { extractCodeBlocks, classifyBlocks } from './extraction';\nimport { synthesizeVirtualModule } from './synthesis';\n\nexport default class RemotionPlugin extends Plugin {\n    public settings!: PluginSettings;\n    private updateTimeoutId: number | null = null;\n\n    async onload() {\n        await this.loadSettings();\n\n        // Register the Remotion preview view\n        this.registerView(PREVIEW_VIEW_TYPE, (leaf: WorkspaceLeaf) => new PreviewView(leaf));\n\n        this.addRibbonIcon('video', 'Toggle Remotion Preview', async () => {\n            await this.toggleView();\n        });\n\n        // Add settings tab\n        this.addSettingTab(new RemotionSettingTab(this.app, this));\n\n        // Listen for active file changes to auto-manage the preview pane\n        this.registerEvent(\n            this.app.workspace.on('active-leaf-change', () => {\n                this.onActiveLeafChange();\n            })\n        );\n\n        // Debounced updates on editor change\n        this.registerEvent(\n            this.app.workspace.on('editor-change', () => {\n                this.schedulePreviewUpdate();\n            })\n        );\n\n        // Initial check\n        this.onActiveLeafChange();\n\n        console.log('Remotion plugin loaded');\n    }\n\n    async loadSettings() {\n        this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());\n    }\n\n    async saveSettings() {\n        await this.saveData(this.settings);\n    }\n\n    private async onActiveLeafChange() {\n        const activeView = this.app.workspace.getActiveViewOfType(MarkdownView);\n        \n        if (activeView) {\n            // Active file is a markdown note, ensure preview is open\n            await this.activateView();\n            this.schedulePreviewUpdate();\n        } else {\n            // No markdown file active, but keep preview open if user wants it\n            // (They can close it manually or toggle with ribbon icon)\n        }\n    }\n\n    private async toggleView() {\n        const existing = this.app.workspace.getLeavesOfType(PREVIEW_VIEW_TYPE)[0];\n        \n        if (existing) {\n            this.app.workspace.detachLeavesOfType(PREVIEW_VIEW_TYPE);\n        } else {\n            await this.activateView();\n        }\n    }\n\n    private async activateView() {\n        const existing = this.app.workspace.getLeavesOfType(PREVIEW_VIEW_TYPE)[0];\n        \n        if (existing) {\n            this.app.workspace.revealLeaf(existing);\n            return;\n        }\n\n        // Open in right sidebar (similar to backlinks, outline, etc.)\n        const leaf = this.app.workspace.getRightLeaf(false);\n        if (!leaf) return;\n\n        await leaf.setViewState({\n            type: PREVIEW_VIEW_TYPE,\n            active: false,\n        });\n        this.app.workspace.revealLeaf(leaf);\n    }\n\n    private schedulePreviewUpdate() {\n        if (this.updateTimeoutId !== null) {\n            window.clearTimeout(this.updateTimeoutId);\n        }\n\n        this.updateTimeoutId = window.setTimeout(() => {\n            this.updateTimeoutId = null;\n            this.updatePreview();\n        }, 300);\n    }\n\n    private updatePreview() {\n        const activeView = this.app.workspace.getActiveViewOfType(MarkdownView);\n        const previewView = this.getPreviewView();\n        if (!activeView || !previewView) return;\n\n        const blocks = extractCodeBlocks(activeView.editor.getValue());\n        const classified = classifyBlocks(blocks);\n        const synthesized = synthesizeVirtualModule(activeView.file?.path ?? 'Untitled.md', classified);\n        previewView.updateSynthesizedModule(synthesized.code);\n    }\n\n    private getPreviewView(): PreviewView | null {\n        const leaf = this.app.workspace.getLeavesOfType(PREVIEW_VIEW_TYPE)[0];\n        return leaf?.view instanceof PreviewView ? (leaf.view as PreviewView) : null;\n    }\n\n    async onunload() {\n        this.app.workspace.detachLeavesOfType(PREVIEW_VIEW_TYPE);\n    }\n}\n","import type { ClassifiedBlock } from './extraction';\n\nexport interface SceneExport {\n    exportName: string;\n    blockIndex: number;\n    startLine: number;\n}\n\nexport interface SynthesizedModule {\n    code: string;\n    sceneExports: SceneExport[];\n}\n\n/**\n * Synthesize a virtual TSX module by concatenating module blocks and wrapping JSX entry blocks.\n *\n * @param notePath Original markdown file path\n * @param blocks Classified blocks\n * @returns Synthesized module output with scene exports metadata\n */\nexport function synthesizeVirtualModule(\n    notePath: string,\n    blocks: ClassifiedBlock[]\n): SynthesizedModule {\n    const moduleParts: string[] = [];\n    const sceneParts: string[] = [];\n    const sceneExports: SceneExport[] = [];\n\n    const makeSentinel = (block: ClassifiedBlock) => {\n        const line = block.startLine + 1; // 1-based line number in markdown\n        return `// --- block ${block.blockIndex} @ ${notePath}:${line} ---`;\n    };\n\n    for (const block of blocks) {\n        if (block.type === 'module') {\n            moduleParts.push(makeSentinel(block));\n            moduleParts.push(block.content);\n        }\n    }\n\n    for (const block of blocks) {\n        if (block.type === 'jsx-entry') {\n            const exportName = `__scene_${block.blockIndex}`;\n            sceneExports.push({\n                exportName,\n                blockIndex: block.blockIndex,\n                startLine: block.startLine + 1,\n            });\n\n            sceneParts.push(makeSentinel(block));\n            sceneParts.push(\n                `export const ${exportName} = () => (\\n${block.content}\\n);`\n            );\n        }\n    }\n\n    const code = [\n        ...moduleParts,\n        ...sceneParts,\n    ].join('\\n\\n');\n\n    return { code, sceneExports };\n}\n"],"names":["PREVIEW_VIEW_TYPE","PreviewView","ItemView","constructor","leaf","super","this","iframe","icon","getViewType","getDisplayText","onOpen","container","containerEl","children","empty","addClass","createEl","cls","style","width","height","border","backgroundColor","srcdoc","onClose","updateSynthesizedModule","code","_a","contentWindow","postMessage","type","payload","DEFAULT_SETTINGS","defaultFps","defaultWidth","defaultHeight","RemotionSettingTab","PluginSettingTab","app","plugin","display","text","Setting","setName","setDesc","addText","setValue","String","settings","onChange","value","__awaiter","fps","parseInt","isNaN","saveSettings","isLikelyJsxEntry","content","trimmed","trim","startsWith","test","endsWith","RemotionPlugin","Plugin","updateTimeoutId","onload","loadSettings","registerView","addRibbonIcon","toggleView","addSettingTab","registerEvent","workspace","on","onActiveLeafChange","schedulePreviewUpdate","console","log","Object","assign","loadData","saveData","getActiveViewOfType","MarkdownView","activateView","getLeavesOfType","detachLeavesOfType","existing","revealLeaf","getRightLeaf","setViewState","active","window","clearTimeout","setTimeout","updatePreview","activeView","previewView","getPreviewView","classified","blocks","map","block","index","blockIndex","classifyBlocks","lines","split","i","currentOffset","length","line","fenceChar","languageMatch","slice","match","language","includes","startLine","startOffset","blockContent","contentLine","contentTrimmed","endOffset","endLine","push","trimEnd","extractCodeBlocks","editor","getValue","synthesized","notePath","moduleParts","sceneParts","sceneExports","makeSentinel","exportName","join","synthesizeVirtualModule","_b","file","path","view","onunload"],"mappings":"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"}